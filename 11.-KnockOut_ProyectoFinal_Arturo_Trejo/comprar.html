<!DOCTYPE html>

<html>
    <head>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <script src="js/jquery-2.1.3.js "></script>
        <script src="js/kendo.all.min.js"></script>
        <script src="js/knockout-3.1.0.js"></script>
        <script src="js/knockout-kendo.min.js"></script>
        <script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
        <script type="text/javascript" src="js/kendo.validator.min.js"></script>
        <script type="text/javascript" src="js/kendo.web.min.js"></script>

        <link href="css/kendo.common-bootstrap.min.css" rel="stylesheet"/>
        <link href="css/kendo.bootstrap.min.css" rel="stylesheet"/>
        <link href="css/kendo.dataviz.min.css" rel="stylesheet"/>
        <link href="css/kendo.dataviz.bootstrap.min.css" rel="stylesheet"/>

        <link href="bootstrap/css/bootstrap.css" rel="stylesheet" />
        <link href="bootstrap/css/bootstrap-theme.min.css" rel="stylesheet" >
        <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" >


    <script src="tablesorter/jquery.tablesorter.js" type="text/javascript"></script>
    <link rel="stylesheet" href="tablesorter/themes/blue/style.css" media="screen" />

    </head>
      <style>
  .carousel-inner > .item > img,
  .carousel-inner > .item > a > img {
    width: 100%;
    margin: auto;
    max-width: 500px;
  }
  #myCarousel{
    margin-top: 11px;
  }
  </style>

    <body>
          <script type="text/javascript">
    $(document).ready(function() {
        $("#mytable").tablesorter();
    });
    </script>
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">TREDLON Technology</a>
    </div>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="lista.html">Productos</a></li>
        <li><a href="comprar.html">Comprar</a></li>
        <li><a href="contacto.html">Contactanos</a></li>
      </ul>
    </div>
  </div>
</nav>

        <br>
        <br>

        <div class="container">
            <div class="page-header">
                <div class="row">
                    <div class="col-sm-12">
                        <form role="form">
                            <fieldset>
                                <legend>Small Shopping Cart(SSC)<img src="media/cart3.png" alt="cart" width="33" height="33"></legend>
                            </fieldset>
                            <section class="well">
                                <h4 class="ra-well-title">Orden de Compra</h4>

                                <div class="form-horizontal form-widgets col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label col-sm-4" for="producto">Producto</label>
                                        <div class="col-sm-8 col-md-6">
                                            <select id="producto" style="padding: 7PX;border-radius: 5px;border-color: #ccc;" data-bind="options:productos, value:producto, optionsText: 'pnombre', optionsCaption:'Seleccione un Producto'"></select>
                                        </div>
                                    </div>

                                        <div class="form-group">
                                            <label class="control-label col-sm-4" for="precio">Precio</label>
                                            <div class="col-sm-8 col-md-6">
                                              <input style="padding: 7PX;border-radius: 5px;border: 1px solid #ccc;" data-bind='visible: producto, value: getPrice()' id="precio"/>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="control-label col-sm-4" for="cantidad">Cantidad</label>
                                            <div class="col-sm-8 col-md-6">
                                                <input data-bind="kendoNumericTextBox:cantidad" id="cantidad" />
                                            </div>
                                        </div>
                                </div>

                                <div class="form-horizontal form-widgets col-sm-6">
                                   <div class="form-group">
                                        <label class="control-label col-sm-4" for="identificacion">Identificacion</label>
                                        <div class="col-sm-8 col-md-6">
                                            <input type="text" data-bind="kendoMaskedTextBox:identificacion" id="identificacion" placeholder="ID"/>
                                        </div>
                                      </div>

                                      <div class="form-group">
                                        <label class="control-label col-sm-4" for="nombre">Cliente</label>
                                        <div class="col-sm-8 col-md-6">
                                            <input type="text" data-bind="kendoMaskedTextBox:nombre" id="nombre" placeholder="Nombre completo"/>
                                        </div>
                                      </div>
                                </div>

                                <div class="buttons-wrap">
                                    <button data-bind="click:agregar" class="btn  btn-primary">Registrar</button>
                                    <input type="reset" value="Cancelar" name="Cancelar"  class="btn  btn-warning"/>
                                </div>
                              </div>
                            </section> 
                        </form>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                      <h3>Lista de Articulos Comprados</h3>
                      <table id="mytable" class="tablesorter">
                          <thead>
                              <tr>
                                  <th>Identificacion</th>
                                  <th>Cliente</th>
                                  <th>Nombre de Producto</th>
                                  <th>Precio</th>
                                  <th>Cantidad</th>
                                  <th>Subtotal</th>
                                  <th>Total</th>
                              </tr>
                          </thead>
                          <tbody data-bind='foreach: Datos'>
                              <tr>
                                  <td style="width: 100px;">
                                      <span data-bind='text: identificacion'></span>
                                  </td>
                                  <td style="width: 100px;">
                                      <span data-bind='text: cliente'></span>
                                  </td>
                                  <td style="width: 100px;">
                                      <span data-bind='text: producto'></span>
                                  </td>
                                  <td style="width: 100px;">
                                      <span data-bind='text: precio'></span>
                                  </td>
                                  <td style="width: 100px;">
                                      <span data-bind='text: cantidad'></span>
                                  </td>
                                  <td style="width: 100px;">
                                      <span data-bind='text: subtotal'></span>
                                  </td>
                                  <td style="width: 100px;">
                                      <span data-bind='text: $parent.getTotal($data.cliente,$data.subtotal)'></span>
                                  </td>
                                  <td style="width: 100px;">
                                      <a href='#' data-bind='click: $parent.eliminarElemento'>Cancelar Producto</a>
                                  </td>
                              </tr>
                          </tbody>
                      </table>
                    </div>
                </div>
                <div class="row">
                  <br>
                    <div class="buttons-wrap">
                      <button data-bind="click:imprimir" class="btn btn-success">Imprimir</button>
                    </div>
                </div>
            </div>
        </div>
        
        <script>
            function ModeloVista (){

                var self = this;

              self.datosEjemplo = (function (self) {
                "use strict";
                var datos = { productos: [
                        {"pcodigo" : 1, "pnombre": "Tablet Sony Z2", "pprecio" : 4000},
                        { "pcodigo": 2, "pnombre": "Tablet Sony Z3", "pprecio": 5000 },
                        { "pcodigo": 3, "pnombre": "Tablet Sony Z4", "pprecio": 6000 },
                        { "pcodigo": 4, "pnombre": "Cellphone Xperia X2", "pprecio": 3500 },
                        { "pcodigo": 5, "pnombre": "Cellphone Xperia L1", "pprecio": 5400 },
                        { "pcodigo": 6, "pnombre": "Cellphone Xperia XA1", "pprecio": 4890 },
                        { "pcodigo": 7, "pnombre": "Cellphone Xperia E5", "pprecio": 2900 },
                        { "pcodigo": 8, "pnombre": "SmartBand 2", "pprecio": 2700 },
                        { "pcodigo": 9, "pnombre": "SmartBand Talk SWR30", "pprecio": 3600 },
                        { "pcodigo": 10, "pnombre": "SmartWatch 3 SWR50", "pprecio": 4200 }
                    ]
                };
                return {
                    datos: datos
                };
            })(self);  

        self.getPrice = function(){
                  var x = "";
                    try{x = self.producto().pprecio;}
                    catch(e){}
                  return x;
        };
            
                
        self.Producto = function() {
            this.pcodigo = ko.observable();
            this.pnombre = ko.observable();
            this.pprecio = ko.observable();
        };
        self.productos = ko.observableArray([]);

                $.each(self.datosEjemplo.datos.productos, function(i, p) {
                    self.productos.push(new self.Producto()
                        .pcodigo(p.pcodigo)
                        .pnombre(p.pnombre)
                        .pprecio(p.pprecio)
                    );
                });

                self.Datos = ko.observableArray([]);
                self.producto = ko.observable();
                self.precio = ko.observable();
                self.cantidad = ko.observable(1);
                self.identificacion = ko.observable();
                self.nombre = ko.observable();
                
                self.agregar = function (){
                  var nproducto = $('#producto option:selected').text();
                  var nprecio = $('#precio').val();
                  var nc = parseInt($('#cantidad').val());
                  var ni = $('#identificacion').val();
                  var nn = $('#nombre').val();
                  var sub = (nprecio * nc).toFixed(2);

                  self.Datos.push({
                    identificacion: ni,
                    cliente: nn,
                    producto: nproducto,
                    precio: nprecio,
                    cantidad: nc,
                    subtotal: sub
                  });
                };

                self.getTotal = function(c, p) {
                  var total = 0.0;

                  $.each(self.Datos(), function(i, p){
                    if(c == p.cliente) total += parseFloat(p.subtotal);
                  });

                    return total.toFixed(2);
                  };

                self.eliminarElemento = function (elemento){
                    self.Datos.remove(elemento);
                };

                self.imprimir = function(){
                  window.print();
                };


            }
            ko.applyBindings(new ModeloVista());
            
        </script>

    </body>
</html>
